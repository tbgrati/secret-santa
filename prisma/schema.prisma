datasource db {
    provider = "postgresql"
    url      = env("DATABASE_URL")
}

generator client {
    provider = "prisma-client-js"
}

model Group {
    id      String    @id @default(uuid()) @db.Uuid
    name    String
    members GroupPerson[]
}

model Person {
    id      String        @id @default(uuid()) @db.Uuid
    name    String
    groups  GroupPerson[]
    gifter  SecretSanta[] @relation("Gifter")
    giftee  SecretSanta[] @relation("Giftee")
}

model GroupPerson {
    id       String @id @default(uuid()) @db.Uuid
    personId String @db.Uuid
    groupId  String @db.Uuid

    person Person @relation(fields: [personId], references: [id])
    group  Group  @relation(fields: [groupId], references: [id])

    @@unique([personId, groupId])
    //possibly remove Unique identifier since people can belong to different groups
}

model SecretSanta {
    id       String  @id @default(uuid()) @db.Uuid
    gifterId String  @db.Uuid
    gifteeId String  @db.Uuid
    year     Int

    gifter Person @relation("Gifter", fields: [gifterId], references: [id])
    giftee Person @relation("Giftee", fields: [gifteeId], references: [id])

    @@unique([gifterId, gifteeId, year])
    //possibly remove Unique identifier since gifter-giftee can be repeated every 3 years
}
